---
title: "스크리너 — 수백 개 코인 중 3개를 고르는 법"
description: "OKX에 상장된 수백 개의 코인 중 매매할 종목을 자동으로 선정하는 스크리너의 설계와 구현 과정."
pubDate: "2026-03-02"
lang: "ko"
category: "system"
series: "building-owl"
seriesOrder: 2
translationOf: "owl-screener-en"
tags: ["스크리너", "종목선정", "변동성", "유동성", "추세강도", "OKX"]
draft: false
---

OKX에 상장된 USDT 무기한 선물이 몇 개인지 아는가? 대략 300개가 넘는다.

처음에 OWL을 만들 때, 나는 순진하게도 "그냥 다 돌리면 되지 않나?" 라고 생각했다. 300개 종목 전부 모니터링하고, 시그널 나오면 진입하고. 간단하잖아.

간단하지 않았다.

## 왜 종목 선정이 필요한가

첫 번째 문제는 API 호출 제한이다. OKX든 바이낸스든 거래소 API에는 rate limit이 있다. 300개 종목의 캔들 데이터를 매번 불러오려면 시간도 오래 걸리고, 중간에 API가 막혀버린다. 한 번 차단당하면 몇 분은 아무것도 못 한다.

두 번째 문제가 더 근본적이다. **대부분의 코인은 매매할 가치가 없다.** 거래량이 하루 10만 달러도 안 되는 코인이 수두룩하다. 이런 코인에 포지션을 잡으면 슬리피지가 장난이 아니다. 시장가로 진입했는데 원하던 가격에서 2%나 밀려서 체결되는 경험 — 해본 사람은 안다.

세 번째, 횡보하는 코인은 방향성 매매에 쓸모가 없다. OWL의 전략들은 기본적으로 추세를 따라가는 방식이다. 추세가 없는 종목에서 추세 전략을 돌리면? 손절만 반복된다.

그래서 스크리너가 필요하다. 수백 개 중에서 "지금 매매할 만한" 코인 몇 개만 골라내는 필터.

## 1단계: 후보군 걸러내기

가장 먼저 할 일은 전체 마켓에서 후보군을 만드는 것이다. OKX에 있는 모든 마켓 데이터를 불러온 다음, 조건에 맞는 것만 남긴다.

```python
STABLECOIN_BASES = {'USDT', 'USDC', 'DAI', 'BUSD', 'TUSD', 'FDUSD', 'PYUSD'}

def fetch_candidates(ex) -> list[dict]:
    markets = ex.load_markets()
    candidates = []
    for symbol, m in markets.items():
        if m.get('swap') and m.get('quote') == 'USDT' and m.get('active'):
            base = m.get('base', '')
            if base not in STABLECOIN_BASES:
                candidates.append(symbol)
    return candidates
```

세 가지 기본 필터를 통과해야 한다:

1. **USDT 무기한 선물만.** 현물은 숏을 칠 수 없다. OWL은 양방향 매매가 핵심이라 선물이 필수.
2. **활성화된 마켓만.** 상장 폐지 예정이거나 거래 정지된 종목은 제외.
3. **스테이블코인 제외.** USDT/USDT 같은 페어는 당연히 의미 없다. USDC, DAI, BUSD 등도 전부 빼야 한다. 처음에 이걸 안 해서 FDUSD/USDT 같은 것에 시그널이 뜨는 황당한 상황이 있었다. 스테이블코인끼리의 변동성을 "기회"로 잡아낸 거다. 당연히 말이 안 된다.

여기까지 거르면 대략 250~300개 정도가 남는다. 아직 너무 많다.

## 2단계: 거래량 필터

다음은 최소 거래량 기준이다. 24시간 거래량이 일정 수준 이하인 코인은 바로 탈락시킨다.

```python
ticker = ex.fetch_ticker(symbol)
base_vol = float(ticker.get('baseVolume') or 0)
last_price = float(ticker.get('last') or 0)
vol_24h = float(ticker.get('quoteVolume') or 0) or (base_vol * last_price)
if vol_24h < min_volume:
    return None
```

현재 기준은 약 100만 달러. `quoteVolume`이 있으면 그걸 쓰고, 없으면 `baseVolume * last_price`로 계산한다. 거래소마다 데이터 형식이 조금씩 달라서 이런 방어 코드가 필요하다. ccxt가 많이 통일해주긴 하지만 완벽하지는 않다.

100만 달러 기준을 적용하면 후보가 대략 80~120개로 줄어든다. 여전히 많지만, 여기서부터는 점수를 매겨서 순위를 정한다.

## 3단계: 4가지 기준으로 점수 매기기

여기가 스크리너의 핵심이다. 남은 후보들에게 0~100점 사이의 점수를 부여한다. 점수는 4가지 요소의 가중 평균이다.

### 변동성 — 25%

가만히 있는 코인은 돈을 벌 수가 없다. 적당히 움직여야 진입과 청산에 수익 구간이 생긴다.

변동성은 ATR(Average True Range)로 측정한다. 4시간봉 50개를 기준으로 14기간 ATR을 계산하고, 현재 가격 대비 비율로 변환한다.

```python
atr_vals = atr(highs, lows, closes, 14)
latest_atr = next((v for v in reversed(atr_vals) if v is not None), None)
volatility = (latest_atr / closes[-1] * 100) if latest_atr and closes[-1] else 0
```

왜 단순 변동률이 아니라 ATR인가? 24시간 변동률은 하루 스냅샷이다. 오늘 3% 올랐다고 해서 평소에 변동성이 큰 코인인지 알 수 없다. 뉴스 하나에 급등한 것일 수도 있다. ATR은 일정 기간의 평균적인 움직임 폭이라 더 안정적인 지표다.

기준은 5%. ATR 기반 변동성이 5%면 만점에 가깝고, 그보다 낮으면 점수가 깎인다. 너무 높으면? 사실 그것도 위험하지만, 현재 스크리너에서는 높은 변동성에 페널티를 주진 않는다. 이건 나중에 개선할 부분이다.

### 24시간 움직임 — 15%

이건 단순하다. 지금 이 코인이 오늘 얼마나 움직였는가.

```python
change_24h = float(ticker.get('percentage') or 0)
```

절대값을 쓴다. 10% 올랐든 10% 떨어졌든 상관없다. 중요한 건 "움직이고 있다"는 사실이다. OWL은 롱도 숏도 치니까 방향은 중요하지 않다. 활발하게 움직이는 코인이 기회가 더 많다.

비중이 15%로 가장 낮은 이유는 이게 너무 단기 지표라서다. 오늘 크게 움직였어도 내일은 죽은 듯이 횡보할 수 있다. 참고 지표 정도로만 쓴다.

### 추세 강도 — 30%

여기서부터 중요하다. OWL의 전략들은 추세를 따라가는 성격이 강하다. 추세가 뚜렷한 종목이 수익 확률이 높다.

추세 강도는 EMA(지수이동평균) 3개의 정렬 상태로 판단한다:

```python
ema9 = ema(closes, 9)
ema21 = ema(closes, 21)
ema50 = ema(closes, 50)

trend = 0
if all(v is not None for v in [ema9[-1], ema21[-1], ema50[-1]]):
    if ema9[-1] > ema21[-1] > ema50[-1]:
        trend = 100  # 강한 상승 추세
    elif ema9[-1] < ema21[-1] < ema50[-1]:
        trend = 80   # 강한 하락 추세 (숏 기회)
    elif ema9[-1] > ema21[-1]:
        trend = 60
    else:
        trend = 30
```

EMA 9 > EMA 21 > EMA 50이면 교과서적인 상승 추세다. 단기, 중기, 장기 이평선이 차곡차곡 위에서부터 정렬되어 있다는 건 지속적으로 올라가고 있다는 뜻이다. 이런 종목에서 롱을 잡으면 추세를 등에 업고 가는 거라 확률이 높다.

반대로 EMA 9 < EMA 21 < EMA 50이면 강한 하락 추세. 이것도 좋다. 숏 기회니까. 점수를 80으로 준 이유는, 솔직히 하락장에서 숏 치는 게 상승장에서 롱 치는 것보다 살짝 더 어렵기 때문이다. 하락은 급격하고 반등도 급격하다. 그래도 추세가 뚜렷하면 여전히 좋은 기회다.

문제는 EMA가 서로 꼬여있는 상태. 이건 추세가 없다는 뜻이다. 점수가 30까지 떨어진다. 이런 종목은 스크리너가 자연스럽게 걸러준다.

### 유동성 — 30%

유동성은 결국 "내 주문이 원하는 가격에 체결될 수 있는가"의 문제다.

```python
import math
liquidity = min(100, math.log10(max(vol_24h, 1)) / math.log10(1e10) * 100)
```

거래량을 로그 스케일로 변환한다. 왜 로그인가? BTC/USDT의 일 거래량은 수십억 달러이고, 소형 알트는 수백만 달러다. 단순 비교하면 BTC 빼고는 전부 0점에 가까워진다. 로그를 쓰면 거래량 1억 달러와 10억 달러의 차이가 크지 않게 된다. 둘 다 충분히 유동성이 좋으니까.

기준이 되는 값은 100억 달러(`1e10`). 이 수준이면 100점이다. 현실적으로 BTC 정도만 만점을 받는다.

유동성의 비중이 30%로 높은 이유가 있다. 초창기에 유동성을 가볍게 봤다가 혼났다. 어떤 소형 알트코인에서 시그널이 떠서 진입했는데, 슬리피지가 너무 커서 진입 시점부터 이미 -1.5%였다. 전략이 아무리 좋아도 진입 비용이 1.5%면 수익 내기 어렵다. 그 이후로 유동성 비중을 높였다.

### 종합 점수

4가지를 합산하는 최종 공식이다:

```python
score = (
    volatility * 25 / 5 +        # 변동성 (5% 기준 정규화)
    abs(change_24h) * 15 / 10 +   # 24h 움직임 (10% 기준)
    trend * 0.30 +                 # 추세 강도 30%
    liquidity * 0.30               # 유동성 30%
)
score = min(100, max(0, score))
```

0~100점으로 클리핑하고, 상위 N개를 선정한다. 현재 N은 3이다. 처음에는 5개, 10개도 해봤는데 종목이 많을수록 각 종목에 할당되는 자본이 작아지고, 관리도 복잡해진다. 3개가 적당했다.

## 보호 메커니즘: 포지션 보유 중인 종목

한 가지 중요한 케이스가 있다. 이미 BTC/USDT에 포지션을 들고 있는 상태에서 스크리너가 다시 돌아갔을 때, BTC가 순위에서 밀려나면 어떻게 되는가?

포지션을 들고 있는데 스크리너가 "이 종목은 이제 아웃"이라고 하면 문제가 된다. 전략 엔진이 해당 종목을 비활성화해서 청산 로직도 안 돌아갈 수 있다.

그래서 포지션이 열려있는 종목은 스크리너 결과와 상관없이 활성 상태를 유지한다. 포지션이 정리된 이후에야 스크리너 결과에 따라 제외될 수 있다. 이 로직이 없었을 때 한 번 버그가 터졌다 — 포지션이 있는데 모니터링이 꺼져서 손절이 안 먹힌 적이 있다. 데모 계좌라 실제 손실은 없었지만 등골이 서늘했다.

## 실제 결과: 결국 대형주

스크리너를 몇 주 돌려보니 패턴이 보인다. 상위 3개에 거의 항상 들어가는 종목이 있다.

**BTC/USDT, ETH/USDT, SOL/USDT.**

가끔 시장이 특별히 흥분하는 날에는 XRP나 DOGE가 끼어들기도 한다. 하지만 대부분의 시간에 상위권은 대형주가 차지한다. 유동성 30%, 추세 강도 30%를 합하면 60%인데, 대형 코인이 이 두 가지에서 압도적이다.

처음에는 이 결과가 좀 실망스러웠다. "스크리너라고 해놓고 결국 BTC, ETH만 하라는 거 아닌가?" 하지만 돌이켜보면 이게 맞다.

1편에서도 썼지만, **소형 알트코인은 기술적 분석이 안 먹힌다.** 차트 패턴이고 뭐고, 일론 머스크 트윗 하나에 30%가 올랐다 내린다. 파동 구조가 없다. EMA가 정렬되어 있어도 갑자기 무너지고, 아무 근거 없이 폭등한다. 이런 종목에서 시스템 트레이딩을 하면 그냥 난수 생성기를 돌리는 것과 다를 바가 없다.

대형주는 다르다. 수십억 달러의 거래량은 개별 행위자의 영향력을 희석시킨다. 차트가 "기술적으로" 움직인다. 지지와 저항이 존재하고, 추세가 한 번 잡히면 관성이 있다. 그래서 기술적 분석이 작동한다.

스크리너가 대형주를 찍어주는 건 버그가 아니라 피처다.

## 교훈과 개선 계획

스크리너를 만들면서 몇 가지를 배웠다.

**첫째, 단순함이 이긴다.** 처음에는 점수 공식에 온갖 지표를 넣으려고 했다. RSI 과매수/과매도, 볼린저밴드 폭, MACD 히스토그램 방향까지. 다 넣으니 종목 선정이 오히려 불안정해졌다. 스크리너는 "대략 이 종목이 괜찮다"를 판단하는 거지, 정밀한 진입 타이밍을 재는 게 아니다. 복잡한 판단은 전략 엔진의 몫이다.

**둘째, 4시간봉이 적당했다.** 처음에 1시간봉을 쓰다가 너무 자주 종목이 바뀌었다. 1시간 전에는 SOL이 1등이었는데 지금은 XRP가 1등이고, 그러다 다시 SOL로 바뀌고. 전략 엔진이 종목 변경에 적응할 시간이 없었다. 4시간봉으로 바꾸니 안정적이 됐다. 종목이 바뀌더라도 최소 몇 시간은 유지된다.

**셋째, 하락 추세도 기회다.** 처음에는 상승 추세인 종목만 높은 점수를 줬다. EMA 정배열이면 100점, 역배열이면 20점 이런 식으로. 그런데 하락장이 오니 스크리너가 추천할 게 아무것도 없었다. 모든 코인이 하락 추세인데 다 낮은 점수가 나오니까. 역배열에도 80점을 주도록 바꾸니 하락장에서도 숏 기회를 잡아낼 수 있게 됐다.

**넷째, 아직 부족하다.** 현재 변동성 점수는 "높을수록 좋다"로 되어 있는데, 사실 너무 높은 변동성은 위험하다. ATR 기반 변동성이 15%를 넘는 코인은 청산 위험이 크다. 적정 범위(3~8% 정도)에 가장 높은 점수를 주는 벨 커브 방식으로 바꿔야 한다. 이건 다음 업데이트에서 할 생각이다.

그리고 상관관계 분석도 넣고 싶다. BTC와 ETH는 움직임이 거의 같다. 둘 다 동시에 들고 있으면 분산 투자 효과가 별로 없다. 스크리너가 상관관계가 낮은 종목 조합을 추천해주면 리스크 분산에 도움이 될 것이다. 하지만 이건 우선순위가 낮다. 지금은 기본 기능이 잘 돌아가는 게 더 중요하다.

## 마치며

스크리너는 OWL 시스템에서 가장 첫 번째 관문이다. 여기서 걸러진 종목만 전략 엔진에 전달되고, 전략 엔진이 시그널을 생성하고, 리스크 매니저가 최종 검증한 후에야 실제 주문이 나간다.

화려한 모듈은 아니다. 점수 공식도 사실 단순한 편이다. 하지만 이게 없으면 시스템 전체가 무의미해진다. 300개 종목에 전략을 다 돌리는 건 비현실적이고, 아무 종목이나 골라서 매매하면 성능이 급격히 떨어진다.

처음엔 "이런 건 금방 만들겠지" 싶었는데, 스테이블코인 필터링, 거래량 계산의 함정, 포지션 보호 로직 같은 예외 케이스들을 하나씩 만나면서 시간이 꽤 걸렸다. 시스템 트레이딩은 핵심 전략보다 이런 주변 장치들에 시간이 더 많이 든다는 걸 배웠다.

다음 글에서는 OWL의 전략 엔진, 그중에서도 첫 번째 전략인 마틴게일 피보나치에 대해 써볼 생각이다. 피보나치 되돌림이 진짜로 작동하는가? 마틴게일은 정말 위험하기만 한 건가? 실제 데이터로 얘기하겠다.

---

*이전 글: [OWL 시스템 소개 — AI 코인 자동매매 시스템을 만들었다](/system/owl-introduction-ko)*
