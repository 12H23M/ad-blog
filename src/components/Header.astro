---
import LanguageToggle from './LanguageToggle.astro';

const { currentPath = '/', lang = 'ko' } = Astro.props;
---

<header class="site-header">
  <div class="header-inner">
    <a href="/" class="logo">TradeLog.dev</a>

    <div class="header-right">
      <nav class="main-nav" id="main-nav">
        <a href="/" class:list={[{ active: currentPath === '/' }]}>
          {lang === 'ko' ? '홈' : 'Home'}
        </a>
        <a href="/blog" class:list={[{ active: currentPath.startsWith('/blog') }]}>
          {lang === 'ko' ? '블로그' : 'Blog'}
        </a>
        <a href="/series" class:list={[{ active: currentPath.startsWith('/series') }]}>
          {lang === 'ko' ? '시리즈' : 'Series'}
        </a>
        <a href="/daily" class:list={[{ active: currentPath.startsWith('/daily') }]}>
          {lang === 'ko' ? '일일 리포트' : 'Daily Log'}
        </a>
        <a href="/about" class:list={[{ active: currentPath.startsWith('/about') }]}>
          {lang === 'ko' ? '소개' : 'About'}
        </a>
      </nav>

      <LanguageToggle currentLang={lang} />

      <button class="mobile-menu-btn" id="mobile-menu-btn" aria-label="Toggle menu">
        &#9776;
      </button>
    </div>
  </div>
</header>

<script>
  function initHeader() {
    const btn = document.getElementById('mobile-menu-btn');
    const nav = document.getElementById('main-nav');
    if (!btn || !nav) return;
    btn.addEventListener('click', () => {
      nav.classList.toggle('open');
      btn.textContent = nav.classList.contains('open') ? '\u2715' : '\u2630';
    });

    // Scroll shadow on header
    const header = document.querySelector('.site-header');
    if (header) {
      const onScroll = () => {
        header.classList.toggle('scrolled', window.scrollY > 10);
      };
      window.addEventListener('scroll', onScroll, { passive: true });
      onScroll();
    }
  }
  document.addEventListener('astro:page-load', initHeader);
  document.addEventListener('DOMContentLoaded', initHeader);
</script>
